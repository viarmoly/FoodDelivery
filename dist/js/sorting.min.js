(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.pagination = void 0;

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

var pagination = {
  list: [],
  pageList: [],
  paginationList: [],
  qtyPagList: [],
  currentPage: 1,
  numberPerPage: 3,
  numberOfPages: 1,
  getScreenWidth: function getScreenWidth() {
    if (window.innerWidth <= 1080) {
      console.log(window.innerWidth);
      this.numberPerPage = 4;
    }
  },
  getNumberOfPages: function getNumberOfPages() {
    return Math.ceil(pagination.list.length / pagination.numberPerPage);
  },
  paginationCheck: function paginationCheck() {
    if (this.numberOfPages <= 1) {
      console.log('what?' + this.numberOfPages);
      pagination.remove();
    }
  },
  makeContentList: function makeContentList() {
    var itemsQty = document.getElementById('container');
    var items = itemsQty.children;
    this.list = _toConsumableArray(items);
    return this.list;
  },
  loadContentList: function loadContentList() {
    var begin = (this.currentPage - 1) * this.numberPerPage;
    var end = begin + this.numberPerPage;
    this.pageList = this.list.slice(begin, end);
    pagination.drawList();
  },
  drawList: function drawList() {
    document.getElementById('container').innerHTML = '';
    var container = document.getElementById('container');
    this.pageList.forEach(function (item) {
      container.appendChild(item);
    });
  },
  makePaginationList: function makePaginationList() {
    var pageConatiner = document.createElement('span');

    for (var i = 1; i <= this.numberOfPages; i++) {
      var pageNumber = document.createElement('a');

      if (i === 1) {
        pageNumber.classList.add('current');
      }

      pageNumber.textContent = "".concat(i);
      pageNumber.addEventListener('click', currentPageNumber);
      pageConatiner.appendChild(pageNumber);
    }

    this.paginationList = _toConsumableArray(pageConatiner.children);
    return this.paginationList;
  },
  paginationCut: function paginationCut() {
    if (this.currentPage <= 6) {
      this.qtyPagList = this.paginationList.slice(0, 10);
    } else if (this.currentPage > 6 && this.currentPage < this.paginationList.length - 4) {
      this.qtyPagList = this.paginationList.slice(this.currentPage - 6, this.currentPage + 4);
    } else if (this.currentPage >= this.paginationList.length - 4) {
      this.qtyPagList = this.paginationList.slice(-10);
    }

    pagination.drawPagination();
  },
  drawPagination: function drawPagination() {
    var pagination = document.getElementById('pagination');
    document.getElementById('pagination').innerHTML = '';
    var first = document.createElement('a');
    var firstIcon = document.createElement('i');
    firstIcon.className = 'fas fa-1x fa-angle-double-left';
    first.appendChild(firstIcon);
    first.addEventListener('click', firstPage);
    pagination.appendChild(first);
    var prev = document.createElement('a');
    var prevIcon = document.createElement('i');
    prevIcon.className = 'fas fa-1x fa-angle-left';
    prev.appendChild(prevIcon);
    prev.addEventListener('click', previousPage);
    pagination.appendChild(prev);
    var pageConatiner = document.createElement('span');
    this.qtyPagList.forEach(function (item) {
      pageConatiner.appendChild(item);
    });
    pagination.appendChild(pageConatiner);
    var next = document.createElement('a');
    var nextIcon = document.createElement('i');
    nextIcon.className = 'fas fa-1x fa-angle-right';
    next.appendChild(nextIcon);
    next.addEventListener('click', nextPage);
    pagination.appendChild(next);
    var last = document.createElement('a');
    var lastIcon = document.createElement('i');
    lastIcon.className = 'fas fa-1x fa-angle-double-right';
    last.appendChild(lastIcon);
    last.addEventListener('click', lastPage);
    pagination.appendChild(last);
  },
  toggleClass: function toggleClass() {
    this.paginationList.forEach(function (item) {
      return item.classList.remove('current');
    });
    this.qtyPagList.forEach(function (item) {
      return item.classList.remove('current');
    });

    if (this.currentPage) {
      this.paginationList[this.currentPage - 1].className = "current";
    }
  },
  remove: function remove() {
    var pagination = document.getElementById('pagination');
    document.getElementById('pagination').innerHTML = '';
  },
  loadEvents: function loadEvents() {
    pagination.paginationCut();
    pagination.toggleClass();
    pagination.loadContentList();
  },
  load: function load() {
    pagination.getScreenWidth();
    pagination.makeContentList();
    this.currentPage = 1;
    this.numberOfPages = pagination.getNumberOfPages();
    pagination.makePaginationList();
    pagination.paginationCut();
    pagination.loadContentList();
    pagination.drawList();
    pagination.paginationCheck();
  }
};
exports.pagination = pagination;

function currentPageNumber(ev) {
  ev.preventDefault();
  var position = parseInt(ev.target.text);

  if (position !== pagination.currentPage) {
    pagination.currentPage = position;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

function nextPage(ev) {
  if (pagination.currentPage !== pagination.numberOfPages) {
    pagination.currentPage += 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  } else {
    ev.preventDefault();
  }
}

function previousPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== 1) {
    pagination.currentPage -= 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  } else {
    ev.preventDefault();
  }
}

function firstPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== 1) {
    pagination.currentPage = 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

function lastPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== pagination.numberOfPages) {
    pagination.currentPage = pagination.numberOfPages;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

},{}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.drawSorting = drawSorting;

var _pagination = require("./pagination");

function drawSorting() {
  var sorting = document.getElementById('filters');
  var catalogFilters = document.createElement('div');
  catalogFilters.className = 'catalog-filters';
  var sortFilters = document.createElement('div');
  sortFilters.className = 'sort-filter';
  var sortLabel = document.createElement('label');
  sortLabel.setAttribute('for', 'sort');
  sortLabel.innerText = 'Сортировать по :';
  var sortSelectBlock = document.createElement('select');
  sortSelectBlock.setAttribute('id', 'sort');
  sortSelectBlock.setAttribute('name', 'sortProducts');
  sortSelectBlock.addEventListener('change', makeSorting);
  var sortByDescendingPrice = document.createElement('option');
  sortByDescendingPrice.setAttribute('value', 'descending');
  sortByDescendingPrice.innerText = 'по убыванию цены';
  sortSelectBlock.appendChild(sortByDescendingPrice);
  var sortByAscendingPrice = document.createElement('option');
  sortByAscendingPrice.setAttribute('value', 'ascending');
  sortByAscendingPrice.innerText = 'по возростанию цены';
  sortSelectBlock.appendChild(sortByAscendingPrice);
  var sortAlphabet = document.createElement('option');
  sortAlphabet.setAttribute('value', 'alphabet');
  sortAlphabet.innerText = 'по алфавиту';
  sortSelectBlock.appendChild(sortAlphabet);
  sortFilters.appendChild(sortLabel);
  sortFilters.appendChild(sortSelectBlock);
  catalogFilters.appendChild(sortFilters);
  sorting.appendChild(catalogFilters);
}

function makeSorting() {
  var value = document.getElementById('sort').value;
  console.log(value);

  if (value === 'ascending') {
    makeAscendingSorting();
  }

  if (value === 'descending') {
    makeDescendingSorting();
  }

  if (value === 'alphabet') {
    makeAlphabetSorting();
  }
}

function makeAscendingSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = parseFloat(list[j].querySelector('div.sm-div p.menu-item-price').textContent);
      var b = parseFloat(list[j + 1].querySelector('div.sm-div p.menu-item-price').textContent);

      if (a > b) {
        change = true;
        var _ref = [list[j + 1], list[j]];
        list[j] = _ref[0];
        list[j + 1] = _ref[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

function makeDescendingSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = parseFloat(list[j].querySelector('div.sm-div p.menu-item-price').textContent);
      var b = parseFloat(list[j + 1].querySelector('div.sm-div p.menu-item-price').textContent);

      if (a < b) {
        change = true;
        var _ref2 = [list[j + 1], list[j]];
        list[j] = _ref2[0];
        list[j + 1] = _ref2[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

function makeAlphabetSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = list[j].querySelector('div.sm-div h2.menu-title').textContent.toLowerCase();
      var b = list[j + 1].querySelector('div.sm-div h2.menu-title').textContent.toLowerCase();

      if (a > b) {
        change = true;
        var _ref3 = [list[j + 1], list[j]];
        list[j] = _ref3[0];
        list[j + 1] = _ref3[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

},{"./pagination":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvcGFnaW5hdGlvbi5qcyIsInNyYy9qcy9zb3J0aW5nLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7O0FDQU8sSUFBTSxVQUFVLEdBQUc7QUFDdEIsRUFBQSxJQUFJLEVBQUUsRUFEZ0I7QUFFdEIsRUFBQSxRQUFRLEVBQUUsRUFGWTtBQUd0QixFQUFBLGNBQWMsRUFBRSxFQUhNO0FBSXRCLEVBQUEsVUFBVSxFQUFFLEVBSlU7QUFLdEIsRUFBQSxXQUFXLEVBQUUsQ0FMUztBQU10QixFQUFBLGFBQWEsRUFBRSxDQU5PO0FBT3RCLEVBQUEsYUFBYSxFQUFFLENBUE87QUFTdEIsRUFBQSxjQVRzQiw0QkFTTDtBQUNiLFFBQUksTUFBTSxDQUFDLFVBQVAsSUFBcUIsSUFBekIsRUFBK0I7QUFDM0IsTUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLE1BQU0sQ0FBQyxVQUFuQjtBQUNBLFdBQUssYUFBTCxHQUFxQixDQUFyQjtBQUNIO0FBQ0osR0FkcUI7QUFpQnRCLEVBQUEsZ0JBakJzQiw4QkFpQkg7QUFDZixXQUFPLElBQUksQ0FBQyxJQUFMLENBQVUsVUFBVSxDQUFDLElBQVgsQ0FBZ0IsTUFBaEIsR0FBeUIsVUFBVSxDQUFDLGFBQTlDLENBQVA7QUFDSCxHQW5CcUI7QUFxQnRCLEVBQUEsZUFyQnNCLDZCQXFCSjtBQUNkLFFBQUksS0FBSyxhQUFMLElBQXNCLENBQTFCLEVBQTZCO0FBQ3pCLE1BQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxVQUFVLEtBQUssYUFBM0I7QUFDQSxNQUFBLFVBQVUsQ0FBQyxNQUFYO0FBQ0g7QUFDSixHQTFCcUI7QUE0QnRCLEVBQUEsZUE1QnNCLDZCQTRCSjtBQUNkLFFBQUksUUFBUSxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLENBQWY7QUFDQSxRQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsUUFBckI7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Q0FBQyxHQUFHLElBQUksQ0FBQyxDQUFELENBQUosQ0FBUSxhQUFSLENBQXNCLDBCQUF0QixFQUFrRCxXQUFsRCxDQUE4RCxXQUE5RCxFQUFSO0FBQ0EsVUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFMLENBQUosQ0FBWSxhQUFaLENBQTBCLDBCQUExQixFQUFzRCxXQUF0RCxDQUFrRSxXQUFsRSxFQUFSOztBQUNBLFVBQUksQ0FBQyxHQUFHLENBQVIsRUFBVztBQUNQLFFBQUEsTUFBTSxHQUFHLElBQVQ7QUFETyxvQkFFa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUwsQ0FBTCxFQUFjLElBQUksQ0FBQyxDQUFELENBQWxCLENBRmxCO0FBRU4sUUFBQSxJQUFJLENBQUMsQ0FBRCxDQUZFO0FBRUcsUUFBQSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUwsQ0FGUDtBQUdWO0FBQ0o7O0FBQ0QsUUFBRyxDQUFDLE1BQUosRUFBWTtBQUNmOztBQUNELEVBQUEsU0FBUyxDQUFDLFNBQVYsR0FBc0IsRUFBdEI7QUFDQSxFQUFBLElBQUksQ0FBQyxPQUFMLENBQWEsVUFBQSxJQUFJLEVBQUk7QUFDakIsSUFBQSxTQUFTLENBQUMsV0FBVixDQUFzQixJQUF0QjtBQUNILEdBRkQ7O0FBR0EseUJBQVcsSUFBWDtBQUNIIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiZXhwb3J0IGNvbnN0IHBhZ2luYXRpb24gPSB7XHJcbiAgICBsaXN0OiBbXSxcclxuICAgIHBhZ2VMaXN0OiBbXSxcclxuICAgIHBhZ2luYXRpb25MaXN0OiBbXSxcclxuICAgIHF0eVBhZ0xpc3Q6IFtdLFxyXG4gICAgY3VycmVudFBhZ2U6IDEsXHJcbiAgICBudW1iZXJQZXJQYWdlOiAzLFxyXG4gICAgbnVtYmVyT2ZQYWdlczogMSxcclxuXHJcbiAgICBnZXRTY3JlZW5XaWR0aCgpIHtcclxuICAgICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPD0gMTA4MCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh3aW5kb3cuaW5uZXJXaWR0aCk7XHJcbiAgICAgICAgICAgIHRoaXMubnVtYmVyUGVyUGFnZSA9IDQ7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgZ2V0TnVtYmVyT2ZQYWdlcygpIHtcclxuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKHBhZ2luYXRpb24ubGlzdC5sZW5ndGggLyBwYWdpbmF0aW9uLm51bWJlclBlclBhZ2UpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYWdpbmF0aW9uQ2hlY2soKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubnVtYmVyT2ZQYWdlcyA8PSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3aGF0PycgKyB0aGlzLm51bWJlck9mUGFnZXMpXHJcbiAgICAgICAgICAgIHBhZ2luYXRpb24ucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBtYWtlQ29udGVudExpc3QoKSB7XHJcbiAgICAgICAgbGV0IGl0ZW1zUXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpO1xyXG4gICAgICAgIGxldCBpdGVtcyA9IGl0ZW1zUXR5LmNoaWxkcmVuO1xyXG4gICAgICAgIHRoaXMubGlzdCA9IFsuLi5pdGVtc107XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdDtcclxuICAgIH0sXHJcblxyXG4gICAgbG9hZENvbnRlbnRMaXN0KCkge1xyXG4gICAgICAgIGxldCBiZWdpbiA9ICgodGhpcy5jdXJyZW50UGFnZSAtIDEpICogdGhpcy5udW1iZXJQZXJQYWdlKTtcclxuICAgICAgICBsZXQgZW5kID0gYmVnaW4gKyB0aGlzLm51bWJlclBlclBhZ2U7XHJcbiAgICAgICAgdGhpcy5wYWdlTGlzdCA9IHRoaXMubGlzdC5zbGljZShiZWdpbiwgZW5kKTtcclxuICAgICAgICBwYWdpbmF0aW9uLmRyYXdMaXN0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGRyYXdMaXN0KCkge1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKS5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMucGFnZUxpc3QuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgbWFrZVBhZ2luYXRpb25MaXN0KCkge1xyXG4gICAgICAgIGxldCBwYWdlQ29uYXRpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHRoaXMubnVtYmVyT2ZQYWdlczsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBwYWdlTnVtYmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgICAgICBpZiAoaSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcGFnZU51bWJlci5jbGFzc0xpc3QuYWRkKCdjdXJyZW50JylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYWdlTnVtYmVyLnRleHRDb250ZW50ID0gYCR7aX1gO1xyXG4gICAgICAgICAgICBwYWdlTnVtYmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3VycmVudFBhZ2VOdW1iZXIpO1xyXG4gICAgICAgICAgICBwYWdlQ29uYXRpbmVyLmFwcGVuZENoaWxkKHBhZ2VOdW1iZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBhZ2luYXRpb25MaXN0ID0gWy4uLnBhZ2VDb25hdGluZXIuY2hpbGRyZW5dO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhZ2luYXRpb25MaXN0O1xyXG4gICAgfSxcclxuXHJcbiAgICBwYWdpbmF0aW9uQ3V0KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlIDw9IDYpIHtcclxuICAgICAgICAgICAgdGhpcy5xdHlQYWdMaXN0ID0gdGhpcy5wYWdpbmF0aW9uTGlzdC5zbGljZSgwLCAxMCk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gNiAmJiB0aGlzLmN1cnJlbnRQYWdlIDwgdGhpcy5wYWdpbmF0aW9uTGlzdC5sZW5ndGggLSA0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucXR5UGFnTGlzdCA9IHRoaXMucGFnaW5hdGlvbkxpc3Quc2xpY2UodGhpcy5jdXJyZW50UGFnZSAtIDYsIHRoaXMuY3VycmVudFBhZ2UgKyA0KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudFBhZ2UgPj0gdGhpcy5wYWdpbmF0aW9uTGlzdC5sZW5ndGggLSA0KSB7XHJcbiAgICAgICAgICAgIHRoaXMucXR5UGFnTGlzdCA9IHRoaXMucGFnaW5hdGlvbkxpc3Quc2xpY2UoLTEwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFnaW5hdGlvbi5kcmF3UGFnaW5hdGlvbigpO1xyXG4gICAgfSxcclxuICAgIGRyYXdQYWdpbmF0aW9uKCkge1xyXG4gICAgICAgIGxldCBwYWdpbmF0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2luYXRpb24nKTtcclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnaW5hdGlvbicpLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAgICAgICBsZXQgZmlyc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgbGV0IGZpcnN0SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICBmaXJzdEljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS0xeCBmYS1hbmdsZS1kb3VibGUtbGVmdCc7XHJcbiAgICAgICAgZmlyc3QuYXBwZW5kQ2hpbGQoZmlyc3RJY29uKTtcclxuICAgICAgICBmaXJzdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZpcnN0UGFnZSk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChmaXJzdCk7XHJcblxyXG4gICAgICAgIGxldCBwcmV2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIGxldCBwcmV2SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICBwcmV2SWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLTF4IGZhLWFuZ2xlLWxlZnQnO1xyXG4gICAgICAgIHByZXYuYXBwZW5kQ2hpbGQocHJldkljb24pO1xyXG4gICAgICAgIHByZXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwcmV2aW91c1BhZ2UpO1xyXG4gICAgICAgIHBhZ2luYXRpb24uYXBwZW5kQ2hpbGQocHJldik7XHJcblxyXG4gICAgICAgIGxldCBwYWdlQ29uYXRpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cclxuICAgICAgICB0aGlzLnF0eVBhZ0xpc3QuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgcGFnZUNvbmF0aW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChwYWdlQ29uYXRpbmVyKTtcclxuXHJcbiAgICAgICAgbGV0IG5leHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgbGV0IG5leHRJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gICAgICAgIG5leHRJY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtMXggZmEtYW5nbGUtcmlnaHQnO1xyXG4gICAgICAgIG5leHQuYXBwZW5kQ2hpbGQobmV4dEljb24pO1xyXG4gICAgICAgIG5leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBuZXh0UGFnZSk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChuZXh0KTtcclxuXHJcbiAgICAgICAgbGV0IGxhc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgbGV0IGxhc3RJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gICAgICAgIGxhc3RJY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtMXggZmEtYW5nbGUtZG91YmxlLXJpZ2h0JztcclxuICAgICAgICBsYXN0LmFwcGVuZENoaWxkKGxhc3RJY29uKTtcclxuICAgICAgICBsYXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGFzdFBhZ2UpO1xyXG4gICAgICAgIHBhZ2luYXRpb24uYXBwZW5kQ2hpbGQobGFzdCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHRvZ2dsZUNsYXNzKCkge1xyXG4gICAgICAgIHRoaXMucGFnaW5hdGlvbkxpc3QuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnY3VycmVudCcpKTtcclxuICAgICAgICB0aGlzLnF0eVBhZ0xpc3QuZm9yRWFjaChpdGVtID0+IGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnY3VycmVudCcpKTtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2luYXRpb25MaXN0W3RoaXMuY3VycmVudFBhZ2UgLSAxXS5jbGFzc05hbWUgPSBcImN1cnJlbnRcIjtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlKCkge1xyXG4gICAgICAgIGxldCBwYWdpbmF0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2luYXRpb24nKTtcclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnaW5hdGlvbicpLmlubmVySFRNTCA9ICcnO1xyXG4gICAgfSxcclxuXHJcbiAgICBsb2FkRXZlbnRzKCkge1xyXG4gICAgICAgIHBhZ2luYXRpb24ucGFnaW5hdGlvbkN1dCgpO1xyXG4gICAgICAgIHBhZ2luYXRpb24udG9nZ2xlQ2xhc3MoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRDb250ZW50TGlzdCgpO1xyXG4gICAgfSxcclxuICAgIGxvYWQoKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5nZXRTY3JlZW5XaWR0aCgpO1xyXG4gICAgICAgIHBhZ2luYXRpb24ubWFrZUNvbnRlbnRMaXN0KCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDE7XHJcbiAgICAgICAgdGhpcy5udW1iZXJPZlBhZ2VzID0gcGFnaW5hdGlvbi5nZXROdW1iZXJPZlBhZ2VzKCk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5tYWtlUGFnaW5hdGlvbkxpc3QoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLnBhZ2luYXRpb25DdXQoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRDb250ZW50TGlzdCgpO1xyXG4gICAgICAgIHBhZ2luYXRpb24uZHJhd0xpc3QoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLnBhZ2luYXRpb25DaGVjaygpXHJcbiAgICB9XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjdXJyZW50UGFnZU51bWJlcihldikge1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIGxldCBwb3NpdGlvbiA9IHBhcnNlSW50KGV2LnRhcmdldC50ZXh0KTtcclxuICAgIGlmIChwb3NpdGlvbiAhPT0gcGFnaW5hdGlvbi5jdXJyZW50UGFnZSkge1xyXG4gICAgICAgIHBhZ2luYXRpb24uY3VycmVudFBhZ2UgPSBwb3NpdGlvbjtcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRFdmVudHMoKTtcclxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5leHRQYWdlKGV2KSB7XHJcbiAgICBpZiAocGFnaW5hdGlvbi5jdXJyZW50UGFnZSAhPT0gcGFnaW5hdGlvbi5udW1iZXJPZlBhZ2VzKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5jdXJyZW50UGFnZSArPSAxO1xyXG4gICAgICAgIHBhZ2luYXRpb24ubG9hZEV2ZW50cygpO1xyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBwcmV2aW91c1BhZ2UoZXYpIHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAocGFnaW5hdGlvbi5jdXJyZW50UGFnZSAhPT0gMSkge1xyXG4gICAgICAgIHBhZ2luYXRpb24uY3VycmVudFBhZ2UgLT0gMTtcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRFdmVudHMoKTtcclxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpcnN0UGFnZShldikge1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmIChwYWdpbmF0aW9uLmN1cnJlbnRQYWdlICE9PSAxKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5jdXJyZW50UGFnZSA9IDE7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5sb2FkRXZlbnRzKCk7XHJcbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBsYXN0UGFnZShldikge1xyXG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmIChwYWdpbmF0aW9uLmN1cnJlbnRQYWdlICE9PSBwYWdpbmF0aW9uLm51bWJlck9mUGFnZXMpIHtcclxuICAgICAgICBwYWdpbmF0aW9uLmN1cnJlbnRQYWdlID0gcGFnaW5hdGlvbi5udW1iZXJPZlBhZ2VzO1xyXG4gICAgICAgIHBhZ2luYXRpb24ubG9hZEV2ZW50cygpO1xyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge3BhZ2luYXRpb259IGZyb20gXCIuL3BhZ2luYXRpb25cIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkcmF3U29ydGluZygpIHtcclxuICAgIGxldCBzb3J0aW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbHRlcnMnKTtcclxuXHJcbiAgICBsZXQgY2F0YWxvZ0ZpbHRlcnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIGNhdGFsb2dGaWx0ZXJzLmNsYXNzTmFtZSA9ICdjYXRhbG9nLWZpbHRlcnMnO1xyXG5cclxuICAgIGxldCBzb3J0RmlsdGVycyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgc29ydEZpbHRlcnMuY2xhc3NOYW1lID0gJ3NvcnQtZmlsdGVyJztcclxuXHJcbiAgICBsZXQgc29ydExhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcclxuICAgIHNvcnRMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdzb3J0Jyk7XHJcbiAgICBzb3J0TGFiZWwuaW5uZXJUZXh0ID0gJ9Ch0L7RgNGC0LjRgNC+0LLQsNGC0Ywg0L/QviA6JztcclxuXHJcbiAgICBsZXQgc29ydFNlbGVjdEJsb2NrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jyk7XHJcbiAgICBzb3J0U2VsZWN0QmxvY2suc2V0QXR0cmlidXRlKCdpZCcsICdzb3J0Jyk7XHJcbiAgICBzb3J0U2VsZWN0QmxvY2suc2V0QXR0cmlidXRlKCduYW1lJywgJ3NvcnRQcm9kdWN0cycpO1xyXG4gICAgc29ydFNlbGVjdEJsb2NrLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG1ha2VTb3J0aW5nKTtcclxuXHJcbiAgICBsZXQgc29ydEJ5RGVzY2VuZGluZ1ByaWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBzb3J0QnlEZXNjZW5kaW5nUHJpY2Uuc2V0QXR0cmlidXRlKCd2YWx1ZScsICdkZXNjZW5kaW5nJyk7XHJcbiAgICBzb3J0QnlEZXNjZW5kaW5nUHJpY2UuaW5uZXJUZXh0ID0gJ9C/0L4g0YPQsdGL0LLQsNC90LjRjiDRhtC10L3Riyc7XHJcbiAgICBzb3J0U2VsZWN0QmxvY2suYXBwZW5kQ2hpbGQoc29ydEJ5RGVzY2VuZGluZ1ByaWNlKTtcclxuXHJcbiAgICBsZXQgc29ydEJ5QXNjZW5kaW5nUHJpY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIHNvcnRCeUFzY2VuZGluZ1ByaWNlLnNldEF0dHJpYnV0ZSgndmFsdWUnLCAnYXNjZW5kaW5nJyk7XHJcbiAgICBzb3J0QnlBc2NlbmRpbmdQcmljZS5pbm5lclRleHQgPSAn0L/QviDQstC+0LfRgNC+0YHRgtCw0L3QuNGOINGG0LXQvdGLJztcclxuICAgIHNvcnRTZWxlY3RCbG9jay5hcHBlbmRDaGlsZChzb3J0QnlBc2NlbmRpbmdQcmljZSk7XHJcblxyXG4gICAgbGV0IHNvcnRBbHBoYWJldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgc29ydEFscGhhYmV0LnNldEF0dHJpYnV0ZSgndmFsdWUnLCAnYWxwaGFiZXQnKTtcclxuICAgIHNvcnRBbHBoYWJldC5pbm5lclRleHQgPSAn0L/QviDQsNC70YTQsNCy0LjRgtGDJztcclxuICAgIHNvcnRTZWxlY3RCbG9jay5hcHBlbmRDaGlsZChzb3J0QWxwaGFiZXQpO1xyXG5cclxuICAgIHNvcnRGaWx0ZXJzLmFwcGVuZENoaWxkKHNvcnRMYWJlbCk7XHJcbiAgICBzb3J0RmlsdGVycy5hcHBlbmRDaGlsZChzb3J0U2VsZWN0QmxvY2spO1xyXG5cclxuICAgIGNhdGFsb2dGaWx0ZXJzLmFwcGVuZENoaWxkKHNvcnRGaWx0ZXJzKTtcclxuICAgIHNvcnRpbmcuYXBwZW5kQ2hpbGQoY2F0YWxvZ0ZpbHRlcnMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtYWtlU29ydGluZygpe1xyXG4gICAgbGV0IHZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvcnQnKS52YWx1ZTtcclxuICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcclxuICAgIGlmKHZhbHVlID09PSAnYXNjZW5kaW5nJyApe1xyXG4gICAgICAgIG1ha2VBc2NlbmRpbmdTb3J0aW5nKCk7XHJcbiAgICB9XHJcbiAgICBpZih2YWx1ZSA9PT0gJ2Rlc2NlbmRpbmcnKXtcclxuICAgICAgICBtYWtlRGVzY2VuZGluZ1NvcnRpbmcoKTtcclxuICAgIH1cclxuICAgIGlmKHZhbHVlID09PSAnYWxwaGFiZXQnKXtcclxuICAgICAgICBtYWtlQWxwaGFiZXRTb3J0aW5nKCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1ha2VBc2NlbmRpbmdTb3J0aW5nKCkge1xyXG4gICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKTtcclxuICAgIGxldCBsaXN0ID0gcGFnaW5hdGlvbi5saXN0O1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGggLSAxOyBpKyspIHtcclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsaXN0Lmxlbmd0aCAtIChpICsgMSk7IGorKykge1xyXG4gICAgICAgICAgICBsZXQgYSA9IHBhcnNlRmxvYXQobGlzdFtqXS5xdWVyeVNlbGVjdG9yKCdkaXYuc20tZGl2IHAubWVudS1pdGVtLXByaWNlJykudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICBsZXQgYiA9IHBhcnNlRmxvYXQobGlzdFtqICsgMV0ucXVlcnlTZWxlY3RvcignZGl2LnNtLWRpdiBwLm1lbnUtaXRlbS1wcmljZScpLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgaWYgKGEgPiBiKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgW2xpc3Rbal0sIGxpc3RbaiArIDFdXSA9IFtsaXN0W2ogKyAxXSwgbGlzdFtqXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIWNoYW5nZSkgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG4gICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxuICAgIH0pO1xyXG4gICAgcGFnaW5hdGlvbi5sb2FkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1ha2VEZXNjZW5kaW5nU29ydGluZygpIHtcclxuICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgICBsZXQgbGlzdCA9IHBhZ2luYXRpb24ubGlzdDtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxpc3QubGVuZ3RoIC0gKGkgKyAxKTsgaisrKSB7XHJcbiAgICAgICAgICAgIGxldCBhID0gcGFyc2VGbG9hdChsaXN0W2pdLnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5zbS1kaXYgcC5tZW51LWl0ZW0tcHJpY2UnKS50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgIGxldCBiID0gcGFyc2VGbG9hdChsaXN0W2ogKyAxXS5xdWVyeVNlbGVjdG9yKCdkaXYuc20tZGl2IHAubWVudS1pdGVtLXByaWNlJykudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICBpZiAoYSA8IGIpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBbbGlzdFtqXSwgbGlzdFtqICsgMV1dID0gW2xpc3RbaiArIDFdLCBsaXN0W2pdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZighY2hhbmdlKSBicmVhaztcclxuICAgIH1cclxuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbiAgICB9KTtcclxuICAgIHBhZ2luYXRpb24ubG9hZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtYWtlQWxwaGFiZXRTb3J0aW5nKCkge1xyXG4gICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWluZXInKTtcclxuICAgIGxldCBsaXN0ID0gcGFnaW5hdGlvbi5saXN0O1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGggLSAxOyBpKyspIHtcclxuICAgICAgICBsZXQgY2hhbmdlID0gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxpc3QubGVuZ3RoIC0gKGkgKyAxKTsgaisrKSB7XHJcbiAgICAgICAgICAgIGxldCBhID0gbGlzdFtqXS5xdWVyeVNlbGVjdG9yKCdkaXYuc20tZGl2IGgyLm1lbnUtdGl0bGUnKS50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICBsZXQgYiA9IGxpc3RbaiArIDFdLnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5zbS1kaXYgaDIubWVudS10aXRsZScpLnRleHRDb250ZW50LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIGlmIChhID4gYikge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIFtsaXN0W2pdLCBsaXN0W2ogKyAxXV0gPSBbbGlzdFtqICsgMV0sIGxpc3Rbal1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFjaGFuZ2UpIGJyZWFrO1xyXG4gICAgfVxyXG4gICAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG4gICAgbGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxuICAgIH0pO1xyXG4gICAgcGFnaW5hdGlvbi5sb2FkKCk7XHJcbn0iXX0=
