(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.pagination = void 0;

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

var pagination = {
  list: [],
  pageList: [],
  paginationList: [],
  qtyPagList: [],
  currentPage: 1,
  numberPerPage: 3,
  numberOfPages: 1,
  getScreenWidth: function getScreenWidth() {
    if (window.innerWidth <= 1080) {
      console.log(window.innerWidth);
      this.numberPerPage = 4;
    }
  },
  getNumberOfPages: function getNumberOfPages() {
    return Math.ceil(pagination.list.length / pagination.numberPerPage);
  },
  makeContentList: function makeContentList() {
    var itemsQty = document.getElementById('container');
    var items = itemsQty.children;
    this.list = _toConsumableArray(items);
    return this.list;
  },
  loadContentList: function loadContentList() {
    var begin = (this.currentPage - 1) * this.numberPerPage;
    var end = begin + this.numberPerPage;
    this.pageList = this.list.slice(begin, end);
    pagination.drawList();
  },
  drawList: function drawList() {
    document.getElementById('container').innerHTML = '';
    var container = document.getElementById('container');
    this.pageList.forEach(function (item) {
      container.appendChild(item);
    });
  },
  makePaginationList: function makePaginationList() {
    var pageConatiner = document.createElement('span');

    for (var i = 1; i <= this.numberOfPages; i++) {
      var pageNumber = document.createElement('a');

      if (i === 1) {
        pageNumber.classList.add('current');
      }

      pageNumber.textContent = "".concat(i);
      pageNumber.addEventListener('click', currentPageNumber);
      pageConatiner.appendChild(pageNumber);
    }

    this.paginationList = _toConsumableArray(pageConatiner.children);
    return this.paginationList;
  },
  paginationCut: function paginationCut() {
    if (this.currentPage <= 6) {
      this.qtyPagList = this.paginationList.slice(0, 10);
    } else if (this.currentPage > 6 && this.currentPage < this.paginationList.length - 4) {
      this.qtyPagList = this.paginationList.slice(this.currentPage - 6, this.currentPage + 4);
    } else if (this.currentPage >= this.paginationList.length - 4) {
      this.qtyPagList = this.paginationList.slice(-10);
    }

    pagination.drawPagination();
  },
  drawPagination: function drawPagination() {
    var pagination = document.getElementById('pagination');
    document.getElementById('pagination').innerHTML = '';
    var first = document.createElement('a');
    var firstIcon = document.createElement('i');
    firstIcon.className = 'fas fa-1x fa-angle-double-left';
    first.appendChild(firstIcon);
    first.addEventListener('click', firstPage);
    pagination.appendChild(first);
    var prev = document.createElement('a');
    var prevIcon = document.createElement('i');
    prevIcon.className = 'fas fa-1x fa-angle-left';
    prev.appendChild(prevIcon);
    prev.addEventListener('click', previousPage);
    pagination.appendChild(prev);
    var pageConatiner = document.createElement('span');
    this.qtyPagList.forEach(function (item) {
      pageConatiner.appendChild(item);
    });
    pagination.appendChild(pageConatiner);
    var next = document.createElement('a');
    var nextIcon = document.createElement('i');
    nextIcon.className = 'fas fa-1x fa-angle-right';
    next.appendChild(nextIcon);
    next.addEventListener('click', nextPage);
    pagination.appendChild(next);
    var last = document.createElement('a');
    var lastIcon = document.createElement('i');
    lastIcon.className = 'fas fa-1x fa-angle-double-right';
    last.appendChild(lastIcon);
    last.addEventListener('click', lastPage);
    pagination.appendChild(last);
  },
  toggleClass: function toggleClass() {
    this.paginationList.forEach(function (item) {
      return item.classList.remove('current');
    });
    this.qtyPagList.forEach(function (item) {
      return item.classList.remove('current');
    });

    if (this.currentPage) {
      this.paginationList[this.currentPage - 1].className = "current";
    }
  },
  remove: function remove() {
    var pagination = document.getElementById('pagination');
    document.getElementById('pagination').innerHTML = '';
  },
  loadEvents: function loadEvents() {
    pagination.paginationCut();
    pagination.toggleClass();
    pagination.loadContentList();
  },
  load: function load() {
    pagination.getScreenWidth();
    pagination.makeContentList();
    this.currentPage = 1;
    this.numberOfPages = pagination.getNumberOfPages();
    pagination.makePaginationList();
    pagination.paginationCut();
    pagination.loadContentList();
    pagination.drawList();
  }
};
exports.pagination = pagination;

function currentPageNumber(ev) {
  ev.preventDefault();
  var position = parseInt(ev.target.text);

  if (position !== pagination.currentPage) {
    pagination.currentPage = position;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

function nextPage(ev) {
  if (pagination.currentPage !== pagination.numberOfPages) {
    pagination.currentPage += 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  } else {
    ev.preventDefault();
  }
}

function previousPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== 1) {
    pagination.currentPage -= 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  } else {
    ev.preventDefault();
  }
}

function firstPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== 1) {
    pagination.currentPage = 1;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

function lastPage(ev) {
  ev.preventDefault();

  if (pagination.currentPage !== pagination.numberOfPages) {
    pagination.currentPage = pagination.numberOfPages;
    pagination.loadEvents();
    window.scrollTo(0, 0);
  }
}

},{}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.drawSorting = drawSorting;

var _pagination = require("./pagination");

function drawSorting() {
  var sorting = document.getElementById('filters');
  var catalogFilters = document.createElement('div');
  catalogFilters.className = 'catalog-filters';
  var sortFilters = document.createElement('div');
  sortFilters.className = 'sort-filter';
  var sortLabel = document.createElement('label');
  sortLabel.setAttribute('for', 'sort');
  sortLabel.innerText = 'Сортировать по :';
  var sortSelectBlock = document.createElement('select');
  sortSelectBlock.setAttribute('id', 'sort');
  sortSelectBlock.setAttribute('name', 'sortProducts');
  sortSelectBlock.addEventListener('change', makeSorting);
  var sortByDescendingPrice = document.createElement('option');
  sortByDescendingPrice.setAttribute('value', 'descending');
  sortByDescendingPrice.innerText = 'по убыванию цены';
  sortSelectBlock.appendChild(sortByDescendingPrice);
  var sortByAscendingPrice = document.createElement('option');
  sortByAscendingPrice.setAttribute('value', 'ascending');
  sortByAscendingPrice.innerText = 'по возростанию цены';
  sortSelectBlock.appendChild(sortByAscendingPrice);
  var sortAlphabet = document.createElement('option');
  sortAlphabet.setAttribute('value', 'alphabet');
  sortAlphabet.innerText = 'по алфавиту';
  sortSelectBlock.appendChild(sortAlphabet);
  sortFilters.appendChild(sortLabel);
  sortFilters.appendChild(sortSelectBlock);
  catalogFilters.appendChild(sortFilters);
  sorting.appendChild(catalogFilters);
}

function makeSorting() {
  var value = document.getElementById('sort').value;
  console.log(value);

  if (value === 'ascending') {
    makeAscendingSorting();
  }

  if (value === 'descending') {
    makeDescendingSorting();
  }

  if (value === 'alphabet') {
    makeAlphabetSorting();
  }
}

function makeAscendingSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = parseFloat(list[j].querySelector('div.sm-div p.menu-item-price').textContent);
      var b = parseFloat(list[j + 1].querySelector('div.sm-div p.menu-item-price').textContent);

      if (a > b) {
        change = true;
        var _ref = [list[j + 1], list[j]];
        list[j] = _ref[0];
        list[j + 1] = _ref[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

function makeDescendingSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = parseFloat(list[j].querySelector('div.sm-div p.menu-item-price').textContent);
      var b = parseFloat(list[j + 1].querySelector('div.sm-div p.menu-item-price').textContent);

      if (a < b) {
        change = true;
        var _ref2 = [list[j + 1], list[j]];
        list[j] = _ref2[0];
        list[j + 1] = _ref2[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

function makeAlphabetSorting() {
  var container = document.getElementById('container');
  var list = _pagination.pagination.list;

  for (var i = 0; i < list.length - 1; i++) {
    var change = false;

    for (var j = 0; j < list.length - (i + 1); j++) {
      var a = list[j].querySelector('div.sm-div h2.menu-title').textContent.toLowerCase();
      var b = list[j + 1].querySelector('div.sm-div h2.menu-title').textContent.toLowerCase();

      if (a > b) {
        change = true;
        var _ref3 = [list[j + 1], list[j]];
        list[j] = _ref3[0];
        list[j + 1] = _ref3[1];
      }
    }

    if (!change) break;
  }

  container.innerHTML = '';
  list.forEach(function (item) {
    container.appendChild(item);
  });

  _pagination.pagination.load();
}

},{"./pagination":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvcGFnaW5hdGlvbi5qcyIsInNyYy9qcy9zb3J0aW5nLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7O0FDQU8sSUFBTSxVQUFVLEdBQUc7QUFDdEIsRUFBQSxJQUFJLEVBQUUsRUFEZ0I7QUFFdEIsRUFBQSxRQUFRLEVBQUUsRUFGWTtBQUd0QixFQUFBLGNBQWMsRUFBRSxFQUhNO0FBSXRCLEVBQUEsVUFBVSxFQUFFLEVBSlU7QUFLdEIsRUFBQSxXQUFXLEVBQUUsQ0FMUztBQU10QixFQUFBLGFBQWEsRUFBRSxDQU5PO0FBT3RCLEVBQUEsYUFBYSxFQUFFLENBUE87QUFTdEIsRUFBQSxjQVRzQiw0QkFTTjtBQUNkLFFBQUcsTUFBTSxDQUFDLFVBQVAsSUFBcUIsSUFBeEIsRUFBNkI7QUFDekIsTUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLE1BQU0sQ0FBQyxVQUFuQjtBQUNBLFdBQUssYUFBTCxHQUFxQixDQUFyQjtBQUNIO0FBQ0YsR0FkcUI7QUFnQnRCLEVBQUEsZ0JBaEJzQiw4QkFnQkg7QUFDZixXQUFPLElBQUksQ0FBQyxJQUFMLENBQVUsVUFBVSxDQUFDLElBQVgsQ0FBZ0IsTUFBaEIsR0FBeUIsVUFBVSxDQUFDLGFBQTlDLENBQVA7QUFDSCxHQWxCcUI7QUFvQnRCLEVBQUEsZUFwQnNCLDZCQW9CSjtBQUNkLFFBQUksUUFBUSxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLENBQWY7QUFDQSxRQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsUUFBckI7QUFDQSxTQUFLLElBQUwsc0JBQWdCLEtBQWhCO0FBQ0EsV0FBTyxLQUFLLElBQVo7QUFDSCxHQXpCcUI7QUEyQnRCLEVBQUEsZUEzQnNCLDZCQTJCSjtBQUNkLFFBQUksS0FBSyxHQUFJLENBQUMsS0FBSyxXQUFMLEdBQW1CLENBQXBCLElBQXlCLEtBQUssYUFBM0M7QUFDQSxRQUFJLEdBQUcsR0FBRyxLQUFLLEdBQUcsS0FBSyxhQUF2QjtBQUNBLFNBQUssUUFBTCxHQUFnQixLQUFLLElBQUwsQ0FBVSxLQUFWLENBQWdCLEtBQWhCLEVBQXVCLEdBQXZCLENBQWhCO0FBQ0EsSUFBQSxVQUFVLENBQUMsUUFBWDtBQUNILEdBaENxQjtBQWtDdEIsRUFBQSxRQWxDc0Isc0JBa0NYO0FBQ1AsSUFBQSxRQUFRLENBQUMsY0FBVCxDQUF3QixXQUF4QixFQUFxQyxTQUFyQyxHQUFpRCxFQUFqRDtBQUNBLFFBQUksU0FBUyxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLENBQWhCO0FBQ0EsU0FBSyxRQUFMLENBQWMsT0FBZCxDQUFzQixVQUFDLElBQUQsRUFBVTtBQUM1QixNQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCO0FBQ0gsS0FGRDtBQUdILEdBeENxQjtBQXlDdEIsRUFBQSxrQkF6Q3NCLGdDQXlDRDtBQUNqQixRQUFJLGFBQWEsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixNQUF2QixDQUFwQjs7QUFDQSxTQUFLLElBQUksQ0FBQyxHQUFHLENBQWIsRUFBZ0IsQ0FBQyxJQUFJLEtBQUssYUFBMUIsRUFBeUMsQ0FBQyxFQUExQyxFQUE4QztBQUMxQyxVQUFJLFVBQVUsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixHQUF2QixDQUFqQjs7QUFDQSxVQUFJLENBQUMsS0FBSyxDQUFWLEVBQWE7QUFDVCxRQUFBLFVBQVUsQ0FBQyxTQUFYLENBQXFCLEdBQXJCLENBQXlCLFNBQXpCO0FBQ0g7O0FBQ0QsTUFBQSxVQUFVLENBQUMsV0FBWCxhQUE0QixDQUE1QjtBQUNBLE1BQUEsVUFBVSxDQUFDLGdCQUFYLENBQTRCLE9BQTVCLEVBQXFDLGlCQUFyQztBQUNBLE1BQUEsYUFBYSxDQUFDLFdBQWQsQ0FBMEIsVUFBMUI7QUFDSDs7QUFDRCxTQUFLLGNBQUwsc0JBQTBCLGFBQWEsQ0FBQyxRQUF4QztBQUNBLFdBQU8sS0FBSyxjQUFaO0FBQ0gsR0F0RHFCO0FBd0R0QixFQUFBLGFBeERzQiwyQkF3RE47QUFDWixRQUFJLEtBQUssV0FBTCxJQUFvQixDQUF4QixFQUEyQjtBQUN2QixXQUFLLFVBQUwsR0FBa0IsS0FBSyxjQUFMLENBQW9CLEtBQXBCLENBQTBCLENBQTFCLEVBQTZCLEVBQTdCLENBQWxCO0FBQ0gsS0FGRCxNQUVPLElBQUksS0FBSyxXQUFMLEdBQW1CLENBQW5CLElBQXdCLEtBQUssV0FBTCxHQUFtQixLQUFLLGNBQUwsQ0FBb0IsTUFBcEIsR0FBNkIsQ0FBNUUsRUFBK0U7QUFDbEYsV0FBSyxVQUFMLEdBQWtCLEtBQUssY0FBTCxDQUFvQixLQUFwQixDQUEwQixLQUFLLFdBQUwsR0FBbUIsQ0FBN0MsRUFBZ0QsS0FBSyxXQUFMLEdBQW1CLENBQW5FLENBQWxCO0FBQ0gsS0FGTSxNQUVBLElBQUksS0FBSyxXQUFMLElBQW9CLEtBQUssY0FBTCxDQUFvQixNQUFwQixHQUE2QixDQUFyRCxFQUF3RDtBQUMzRCxXQUFLLFVBQUwsR0FBa0IsS0FBSyxjQUFMLENBQW9CLEtBQXBCLENBQTBCLENBQUMsRUFBM0IsQ0FBbEI7QUFDSDs7QUFDRCxJQUFBLFVBQVUsQ0FBQyxjQUFYO0FBQ0gsR0FqRXFCO0FBa0V0QixFQUFBLGNBbEVzQiw0QkFrRUw7QUFDYixRQUFJLFVBQVUsR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixZQUF4QixDQUFqQjtBQUNBLElBQUEsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsWUFBeEIsRUFBc0MsU0FBdEMsR0FBa0QsRUFBbEQ7QUFFQSxRQUFJLEtBQUssR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixHQUF2QixDQUFaO0FBQ0EsUUFBSSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsR0FBdkIsQ0FBaEI7QUFDQSxJQUFBLFNBQVMsQ0FBQyxTQUFWLEdBQXNCLGdDQUF0QjtBQUNBLElBQUEsS0FBSyxDQUFDLFdBQU4sQ0FBa0IsU0FBbEI7QUFDQSxJQUFBLEtBQUssQ0FBQyxnQkFBTixDQUF1QixPQUF2QixFQUFnQyxTQUFoQztBQUNBLElBQUEsVUFBVSxDQUFDLFdBQVgsQ0FBdUIsS0FBdkI7QUFFQSxRQUFJLElBQUksR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixHQUF2QixDQUFYO0FBQ0EsUUFBSSxRQUFRLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsR0FBdkIsQ0FBZjtBQUNBLElBQUEsUUFBUSxDQUFDLFNBQVQsR0FBcUIseUJBQXJCO0FBQ0EsSUFBQSxJQUFJLENBQUMsV0FBTCxDQUFpQixRQUFqQjtBQUNBLElBQUEsSUFBSSxDQUFDLGdCQUFMLENBQXNCLE9BQXRCLEVBQStCLFlBQS9CO0FBQ0EsSUFBQSxVQUFVLENBQUMsV0FBWCxDQUF1QixJQUF2QjtBQUVBLFFBQUksYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLE1BQXZCLENBQXBCO0FBRUEsU0FBSyxVQUFMLENBQWdCLE9BQWhCLENBQXdCLFVBQUEsSUFBSSxFQUFJO0FBQzVCLE1BQUEsYUFBYSxDQUFDLFdBQWQsQ0FBMEIsSUFBMUI7QUFDSCxLQUZEO0FBSUEsSUFBQSxVQUFVLENBQUMsV0FBWCxDQUF1QixhQUF2QjtBQUVBLFFBQUksSUFBSSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLEdBQXZCLENBQVg7QUFDQSxRQUFJLFFBQVEsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixHQUF2QixDQUFmO0FBQ0EsSUFBQSxRQUFRLENBQUMsU0FBVCxHQUFxQiwwQkFBckI7QUFDQSxJQUFBLElBQUksQ0FBQyxXQUFMLENBQWlCLFFBQWpCO0FBQ0EsSUFBQSxJQUFJLENBQUMsZ0JBQUwsQ0FBc0IsT0FBdEIsRUFBK0IsUUFBL0I7QUFDQSxJQUFBLFVBQVUsQ0FBQyxXQUFYLENBQXVCLElBQXZCO0FBRUEsUUFBSSxJQUFJLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsR0FBdkIsQ0FBWDtBQUNBLFFBQUksUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLEdBQXZCLENBQWY7QUFDQSxJQUFBLFFBQVEsQ0FBQyxTQUFULEdBQXFCLGlDQUFyQjtBQUNBLElBQUEsSUFBSSxDQUFDLFdBQUwsQ0FBaUIsUUFBakI7QUFDQSxJQUFBLElBQUksQ0FBQyxnQkFBTCxDQUFzQixPQUF0QixFQUErQixRQUEvQjtBQUNBLElBQUEsVUFBVSxDQUFDLFdBQVgsQ0FBdUIsSUFBdkI7QUFDSCxHQXpHcUI7QUEyR3RCLEVBQUEsV0EzR3NCLHlCQTJHUjtBQUNWLFNBQUssY0FBTCxDQUFvQixPQUFwQixDQUE0QixVQUFBLElBQUk7QUFBQSxhQUFJLElBQUksQ0FBQyxTQUFMLENBQWUsTUFBZixDQUFzQixTQUF0QixDQUFKO0FBQUEsS0FBaEM7QUFDQSxTQUFLLFVBQUwsQ0FBZ0IsT0FBaEIsQ0FBd0IsVUFBQSxJQUFJO0FBQUEsYUFBSSxJQUFJLENBQUMsU0FBTCxDQUFlLE1BQWYsQ0FBc0IsU0FBdEIsQ0FBSjtBQUFBLEtBQTVCOztBQUNBLFFBQUksS0FBSyxXQUFULEVBQXNCO0FBQ2xCLFdBQUssY0FBTCxDQUFvQixLQUFLLFdBQUwsR0FBbUIsQ0FBdkMsRUFBMEMsU0FBMUMsR0FBc0QsU0FBdEQ7QUFDSDtBQUNKLEdBakhxQjtBQWtIdEIsRUFBQSxNQWxIc0Isb0JBa0hkO0FBQ0osUUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsWUFBeEIsQ0FBakI7QUFDQSxJQUFBLFFBQVEsQ0FBQyxjQUFULENBQXdCLFlBQXhCLEVBQXNDLFNBQXRDLEdBQWtELEVBQWxEO0FBQ0gsR0FySHFCO0FBdUh0QixFQUFBLFVBdkhzQix3QkF1SFQ7QUFDVCxJQUFBLFVBQVUsQ0FBQyxhQUFYO0FBQ0EsSUFBQSxVQUFVLENBQUMsV0FBWDtBQUNBLElBQUEsVUFBVSxDQUFDLGVBQVg7QUFDSCxHQTNIcUI7QUE0SHRCLEVBQUEsSUE1SHNCLGtCQTRIZjtBQUNILElBQUEsVUFBVSxDQUFDLGNBQVg7QUFDQSxJQUFBLFVBQVUsQ0FBQyxlQUFYO0FBQ0EsU0FBSyxXQUFMLEdBQW1CLENBQW5CO0FBQ0EsU0FBSyxhQUFMLEdBQXFCLFVBQVUsQ0FBQyxnQkFBWCxFQUFyQjtBQUNBLElBQUEsVUFBVSxDQUFDLGtCQUFYO0FBQ0EsSUFBQSxVQUFVLENBQUMsYUFBWDtBQUNBLElBQUEsVUFBVSxDQUFDLGVBQVg7QUFFQSxJQUFBLFVBQVUsQ0FBQyxRQUFYO0FBQ0g7QUF0SXFCLENBQW5COzs7QUF5SVAsU0FBUyxpQkFBVCxDQUEyQixFQUEzQixFQUErQjtBQUMzQixFQUFBLEVBQUUsQ0FBQyxjQUFIO0FBQ0EsTUFBSSxRQUFRLEdBQUcsUUFBUSxDQUFDLEVBQUUsQ0FBQyxNQUFILENBQVUsSUFBWCxDQUF2Qjs7QUFDQSxNQUFJLFFBQVEsS0FBSyxVQUFVLENBQUMsV0FBNUIsRUFBeUM7QUFDckMsSUFBQSxVQUFVLENBQUMsV0FBWCxHQUF5QixRQUF6QjtBQUNBLElBQUEsVUFBVSxDQUFDLFVBQVg7QUFDQSxJQUFBLE1BQU0sQ0FBQyxRQUFQLENBQWdCLENBQWhCLEVBQW1CLENBQW5CO0FBQ0g7QUFDSjs7QUFFRCxTQUFTLFFBQVQsQ0FBa0IsRUFBbEIsRUFBc0I7QUFDbEIsTUFBSSxVQUFVLENBQUMsV0FBWCxLQUEyQixVQUFVLENBQUMsYUFBMUMsRUFBeUQ7QUFDckQsSUFBQSxVQUFVLENBQUMsV0FBWCxJQUEwQixDQUExQjtBQUNBLElBQUEsVUFBVSxDQUFDLFVBQVg7QUFDQSxJQUFBLE1BQU0sQ0FBQyxRQUFQLENBQWdCLENBQWhCLEVBQW1CLENBQW5CO0FBQ0gsR0FKRCxNQUlPO0FBQ0gsSUFBQSxFQUFFLENBQUMsY0FBSDtBQUNIO0FBQ0o7O0FBRUQsU0FBUyxZQUFULENBQXNCLEVBQXRCLEVBQTBCO0FBQ3RCLEVBQUEsRUFBRSxDQUFDLGNBQUg7O0FBQ0EsTUFBSSxVQUFVLENBQUMsV0FBWCxLQUEyQixDQUEvQixFQUFrQztBQUM5QixJQUFBLFVBQVUsQ0FBQyxXQUFYLElBQTBCLENBQTFCO0FBQ0EsSUFBQSxVQUFVLENBQUMsVUFBWDtBQUNBLElBQUEsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsQ0FBaEIsRUFBbUIsQ0FBbkI7QUFDSCxHQUpELE1BSU87QUFDSCxJQUFBLEVBQUUsQ0FBQyxjQUFIO0FBQ0g7QUFDSjs7QUFFRCxTQUFTLFNBQVQsQ0FBbUIsRUFBbkIsRUFBdUI7QUFDbkIsRUFBQSxFQUFFLENBQUMsY0FBSDs7QUFDQSxNQUFJLFVBQVUsQ0FBQyxXQUFYLEtBQTJCLENBQS9CLEVBQWtDO0FBQzlCLElBQUEsVUFBVSxDQUFDLFdBQVgsR0FBeUIsQ0FBekI7QUFDQSxJQUFBLFVBQVUsQ0FBQyxVQUFYO0FBQ0EsSUFBQSxNQUFNLENBQUMsUUFBUCxDQUFnQixDQUFoQixFQUFtQixDQUFuQjtBQUNIO0FBQ0o7O0FBRUQsU0FBUyxRQUFULENBQWtCLEVBQWxCLEVBQXNCO0FBQ2xCLEVBQUEsRUFBRSxDQUFDLGNBQUg7O0FBQ0EsTUFBSSxVQUFVLENBQUMsV0FBWCxLQUEyQixVQUFVLENBQUMsYUFBMUMsRUFBeUQ7QUFDckQsSUFBQSxVQUFVLENBQUMsV0FBWCxHQUF5QixVQUFVLENBQUMsYUFBcEM7QUFDQSxJQUFBLFVBQVUsQ0FBQyxVQUFYO0FBQ0EsSUFBQSxNQUFNLENBQUMsUUFBUCxDQUFnQixDQUFoQixFQUFtQixDQUFuQjtBQUNIO0FBQ0o7Ozs7Ozs7Ozs7QUN4TEQ7O0FBRU8sU0FBUyxXQUFULEdBQXVCO0FBQzFCLE1BQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFNBQXhCLENBQWQ7QUFFQSxNQUFJLGNBQWMsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixLQUF2QixDQUFyQjtBQUNBLEVBQUEsY0FBYyxDQUFDLFNBQWYsR0FBMkIsaUJBQTNCO0FBRUEsTUFBSSxXQUFXLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsS0FBdkIsQ0FBbEI7QUFDQSxFQUFBLFdBQVcsQ0FBQyxTQUFaLEdBQXdCLGFBQXhCO0FBRUEsTUFBSSxTQUFTLEdBQUcsUUFBUSxDQUFDLGFBQVQsQ0FBdUIsT0FBdkIsQ0FBaEI7QUFDQSxFQUFBLFNBQVMsQ0FBQyxZQUFWLENBQXVCLEtBQXZCLEVBQThCLE1BQTlCO0FBQ0EsRUFBQSxTQUFTLENBQUMsU0FBVixHQUFzQixrQkFBdEI7QUFFQSxNQUFJLGVBQWUsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixRQUF2QixDQUF0QjtBQUNBLEVBQUEsZUFBZSxDQUFDLFlBQWhCLENBQTZCLElBQTdCLEVBQW1DLE1BQW5DO0FBQ0EsRUFBQSxlQUFlLENBQUMsWUFBaEIsQ0FBNkIsTUFBN0IsRUFBcUMsY0FBckM7QUFDQSxFQUFBLGVBQWUsQ0FBQyxnQkFBaEIsQ0FBaUMsUUFBakMsRUFBMkMsV0FBM0M7QUFFQSxNQUFJLHFCQUFxQixHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFFBQXZCLENBQTVCO0FBQ0EsRUFBQSxxQkFBcUIsQ0FBQyxZQUF0QixDQUFtQyxPQUFuQyxFQUE0QyxZQUE1QztBQUNBLEVBQUEscUJBQXFCLENBQUMsU0FBdEIsR0FBa0Msa0JBQWxDO0FBQ0EsRUFBQSxlQUFlLENBQUMsV0FBaEIsQ0FBNEIscUJBQTVCO0FBRUEsTUFBSSxvQkFBb0IsR0FBRyxRQUFRLENBQUMsYUFBVCxDQUF1QixRQUF2QixDQUEzQjtBQUNBLEVBQUEsb0JBQW9CLENBQUMsWUFBckIsQ0FBa0MsT0FBbEMsRUFBMkMsV0FBM0M7QUFDQSxFQUFBLG9CQUFvQixDQUFDLFNBQXJCLEdBQWlDLHFCQUFqQztBQUNBLEVBQUEsZUFBZSxDQUFDLFdBQWhCLENBQTRCLG9CQUE1QjtBQUVBLE1BQUksWUFBWSxHQUFHLFFBQVEsQ0FBQyxhQUFULENBQXVCLFFBQXZCLENBQW5CO0FBQ0EsRUFBQSxZQUFZLENBQUMsWUFBYixDQUEwQixPQUExQixFQUFtQyxVQUFuQztBQUNBLEVBQUEsWUFBWSxDQUFDLFNBQWIsR0FBeUIsYUFBekI7QUFDQSxFQUFBLGVBQWUsQ0FBQyxXQUFoQixDQUE0QixZQUE1QjtBQUVBLEVBQUEsV0FBVyxDQUFDLFdBQVosQ0FBd0IsU0FBeEI7QUFDQSxFQUFBLFdBQVcsQ0FBQyxXQUFaLENBQXdCLGVBQXhCO0FBRUEsRUFBQSxjQUFjLENBQUMsV0FBZixDQUEyQixXQUEzQjtBQUNBLEVBQUEsT0FBTyxDQUFDLFdBQVIsQ0FBb0IsY0FBcEI7QUFDSDs7QUFFRCxTQUFTLFdBQVQsR0FBc0I7QUFDbEIsTUFBSSxLQUFLLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsTUFBeEIsRUFBZ0MsS0FBNUM7QUFDQSxFQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksS0FBWjs7QUFDQSxNQUFHLEtBQUssS0FBSyxXQUFiLEVBQTBCO0FBQ3RCLElBQUEsb0JBQW9CO0FBQ3ZCOztBQUNELE1BQUcsS0FBSyxLQUFLLFlBQWIsRUFBMEI7QUFDdEIsSUFBQSxxQkFBcUI7QUFDeEI7O0FBQ0QsTUFBRyxLQUFLLEtBQUssVUFBYixFQUF3QjtBQUNwQixJQUFBLG1CQUFtQjtBQUN0QjtBQUNKOztBQUVELFNBQVMsb0JBQVQsR0FBZ0M7QUFDNUIsTUFBSSxTQUFTLEdBQUcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsV0FBeEIsQ0FBaEI7QUFDQSxNQUFJLElBQUksR0FBRyx1QkFBVyxJQUF0Qjs7QUFFQSxPQUFLLElBQUksQ0FBQyxHQUFHLENBQWIsRUFBZ0IsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFMLEdBQWMsQ0FBbEMsRUFBcUMsQ0FBQyxFQUF0QyxFQUEwQztBQUN0QyxRQUFJLE1BQU0sR0FBRyxLQUFiOztBQUNBLFNBQUssSUFBSSxDQUFDLEdBQUcsQ0FBYixFQUFnQixDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQUwsSUFBZSxDQUFDLEdBQUcsQ0FBbkIsQ0FBcEIsRUFBMkMsQ0FBQyxFQUE1QyxFQUFnRDtBQUM1QyxVQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUQsQ0FBSixDQUFRLGFBQVIsQ0FBc0IsOEJBQXRCLEVBQXNELFdBQXZELENBQWxCO0FBQ0EsVUFBSSxDQUFDLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBTCxDQUFKLENBQVksYUFBWixDQUEwQiw4QkFBMUIsRUFBMEQsV0FBM0QsQ0FBbEI7O0FBQ0EsVUFBSSxDQUFDLEdBQUcsQ0FBUixFQUFXO0FBQ1AsUUFBQSxNQUFNLEdBQUcsSUFBVDtBQURPLG1CQUVrQixDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBTCxDQUFMLEVBQWMsSUFBSSxDQUFDLENBQUQsQ0FBbEIsQ0FGbEI7QUFFTixRQUFBLElBQUksQ0FBQyxDQUFELENBRkU7QUFFRyxRQUFBLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBTCxDQUZQO0FBR1Y7QUFDSjs7QUFDRCxRQUFHLENBQUMsTUFBSixFQUFZO0FBQ2Y7O0FBRUQsRUFBQSxTQUFTLENBQUMsU0FBVixHQUFzQixFQUF0QjtBQUNBLEVBQUEsSUFBSSxDQUFDLE9BQUwsQ0FBYSxVQUFBLElBQUksRUFBSTtBQUNqQixJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCO0FBQ0gsR0FGRDs7QUFHQSx5QkFBVyxJQUFYO0FBQ0g7O0FBRUQsU0FBUyxxQkFBVCxHQUFpQztBQUM3QixNQUFJLFNBQVMsR0FBRyxRQUFRLENBQUMsY0FBVCxDQUF3QixXQUF4QixDQUFoQjtBQUNBLE1BQUksSUFBSSxHQUFHLHVCQUFXLElBQXRCOztBQUVBLE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBYixFQUFnQixDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQUwsR0FBYyxDQUFsQyxFQUFxQyxDQUFDLEVBQXRDLEVBQTBDO0FBQ3RDLFFBQUksTUFBTSxHQUFHLEtBQWI7O0FBRUEsU0FBSyxJQUFJLENBQUMsR0FBRyxDQUFiLEVBQWdCLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTCxJQUFlLENBQUMsR0FBRyxDQUFuQixDQUFwQixFQUEyQyxDQUFDLEVBQTVDLEVBQWdEO0FBQzVDLFVBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBRCxDQUFKLENBQVEsYUFBUixDQUFzQiw4QkFBdEIsRUFBc0QsV0FBdkQsQ0FBbEI7QUFDQSxVQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFMLENBQUosQ0FBWSxhQUFaLENBQTBCLDhCQUExQixFQUEwRCxXQUEzRCxDQUFsQjs7QUFDQSxVQUFJLENBQUMsR0FBRyxDQUFSLEVBQVc7QUFDUCxRQUFBLE1BQU0sR0FBRyxJQUFUO0FBRE8sb0JBRWtCLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFMLENBQUwsRUFBYyxJQUFJLENBQUMsQ0FBRCxDQUFsQixDQUZsQjtBQUVOLFFBQUEsSUFBSSxDQUFDLENBQUQsQ0FGRTtBQUVHLFFBQUEsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFMLENBRlA7QUFHVjtBQUNKOztBQUNELFFBQUcsQ0FBQyxNQUFKLEVBQVk7QUFDZjs7QUFDRCxFQUFBLFNBQVMsQ0FBQyxTQUFWLEdBQXNCLEVBQXRCO0FBQ0EsRUFBQSxJQUFJLENBQUMsT0FBTCxDQUFhLFVBQUEsSUFBSSxFQUFJO0FBQ2pCLElBQUEsU0FBUyxDQUFDLFdBQVYsQ0FBc0IsSUFBdEI7QUFDSCxHQUZEOztBQUdBLHlCQUFXLElBQVg7QUFDSDs7QUFFRCxTQUFTLG1CQUFULEdBQStCO0FBQzNCLE1BQUksU0FBUyxHQUFHLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLENBQWhCO0FBQ0EsTUFBSSxJQUFJLEdBQUcsdUJBQVcsSUFBdEI7O0FBRUEsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFiLEVBQWdCLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTCxHQUFjLENBQWxDLEVBQXFDLENBQUMsRUFBdEMsRUFBMEM7QUFDdEMsUUFBSSxNQUFNLEdBQUcsS0FBYjs7QUFHQSxTQUFLLElBQUksQ0FBQyxHQUFHLENBQWIsRUFBZ0IsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFMLElBQWUsQ0FBQyxHQUFHLENBQW5CLENBQXBCLEVBQTJDLENBQUMsRUFBNUMsRUFBZ0Q7QUFDNUMsVUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUQsQ0FBSixDQUFRLGFBQVIsQ0FBc0IsMEJBQXRCLEVBQWtELFdBQWxELENBQThELFdBQTlELEVBQVI7QUFDQSxVQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUwsQ0FBSixDQUFZLGFBQVosQ0FBMEIsMEJBQTFCLEVBQXNELFdBQXRELENBQWtFLFdBQWxFLEVBQVI7O0FBQ0EsVUFBSSxDQUFDLEdBQUcsQ0FBUixFQUFXO0FBQ1AsUUFBQSxNQUFNLEdBQUcsSUFBVDtBQURPLG9CQUVrQixDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBTCxDQUFMLEVBQWMsSUFBSSxDQUFDLENBQUQsQ0FBbEIsQ0FGbEI7QUFFTixRQUFBLElBQUksQ0FBQyxDQUFELENBRkU7QUFFRyxRQUFBLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBTCxDQUZQO0FBR1Y7QUFDSjs7QUFDRCxRQUFHLENBQUMsTUFBSixFQUFZO0FBQ2Y7O0FBQ0QsRUFBQSxTQUFTLENBQUMsU0FBVixHQUFzQixFQUF0QjtBQUNBLEVBQUEsSUFBSSxDQUFDLE9BQUwsQ0FBYSxVQUFBLElBQUksRUFBSTtBQUNqQixJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCO0FBQ0gsR0FGRDs7QUFHQSx5QkFBVyxJQUFYO0FBQ0giLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJleHBvcnQgY29uc3QgcGFnaW5hdGlvbiA9IHtcclxuICAgIGxpc3Q6IFtdLFxyXG4gICAgcGFnZUxpc3Q6IFtdLFxyXG4gICAgcGFnaW5hdGlvbkxpc3Q6IFtdLFxyXG4gICAgcXR5UGFnTGlzdDogW10sXHJcbiAgICBjdXJyZW50UGFnZTogMSxcclxuICAgIG51bWJlclBlclBhZ2U6IDMsXHJcbiAgICBudW1iZXJPZlBhZ2VzOiAxLFxyXG5cclxuICAgIGdldFNjcmVlbldpZHRoKCl7XHJcbiAgICAgIGlmKHdpbmRvdy5pbm5lcldpZHRoIDw9IDEwODApe1xyXG4gICAgICAgICAgY29uc29sZS5sb2cod2luZG93LmlubmVyV2lkdGgpO1xyXG4gICAgICAgICAgdGhpcy5udW1iZXJQZXJQYWdlID0gNDtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZXROdW1iZXJPZlBhZ2VzKCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmNlaWwocGFnaW5hdGlvbi5saXN0Lmxlbmd0aCAvIHBhZ2luYXRpb24ubnVtYmVyUGVyUGFnZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIG1ha2VDb250ZW50TGlzdCgpIHtcclxuICAgICAgICBsZXQgaXRlbXNRdHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgICAgICAgbGV0IGl0ZW1zID0gaXRlbXNRdHkuY2hpbGRyZW47XHJcbiAgICAgICAgdGhpcy5saXN0ID0gWy4uLml0ZW1zXTtcclxuICAgICAgICByZXR1cm4gdGhpcy5saXN0O1xyXG4gICAgfSxcclxuXHJcbiAgICBsb2FkQ29udGVudExpc3QoKSB7XHJcbiAgICAgICAgbGV0IGJlZ2luID0gKCh0aGlzLmN1cnJlbnRQYWdlIC0gMSkgKiB0aGlzLm51bWJlclBlclBhZ2UpO1xyXG4gICAgICAgIGxldCBlbmQgPSBiZWdpbiArIHRoaXMubnVtYmVyUGVyUGFnZTtcclxuICAgICAgICB0aGlzLnBhZ2VMaXN0ID0gdGhpcy5saXN0LnNsaWNlKGJlZ2luLCBlbmQpO1xyXG4gICAgICAgIHBhZ2luYXRpb24uZHJhd0xpc3QoKTtcclxuICAgIH0sXHJcblxyXG4gICAgZHJhd0xpc3QoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpLmlubmVySFRNTCA9ICcnO1xyXG4gICAgICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgICAgICAgdGhpcy5wYWdlTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBtYWtlUGFnaW5hdGlvbkxpc3QoKSB7XHJcbiAgICAgICAgbGV0IHBhZ2VDb25hdGluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdGhpcy5udW1iZXJPZlBhZ2VzOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IHBhZ2VOdW1iZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIGlmIChpID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBwYWdlTnVtYmVyLmNsYXNzTGlzdC5hZGQoJ2N1cnJlbnQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhZ2VOdW1iZXIudGV4dENvbnRlbnQgPSBgJHtpfWA7XHJcbiAgICAgICAgICAgIHBhZ2VOdW1iZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjdXJyZW50UGFnZU51bWJlcik7XHJcbiAgICAgICAgICAgIHBhZ2VDb25hdGluZXIuYXBwZW5kQ2hpbGQocGFnZU51bWJlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGFnaW5hdGlvbkxpc3QgPSBbLi4ucGFnZUNvbmF0aW5lci5jaGlsZHJlbl07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGFnaW5hdGlvbkxpc3Q7XHJcbiAgICB9LFxyXG5cclxuICAgIHBhZ2luYXRpb25DdXQoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPD0gNikge1xyXG4gICAgICAgICAgICB0aGlzLnF0eVBhZ0xpc3QgPSB0aGlzLnBhZ2luYXRpb25MaXN0LnNsaWNlKDAsIDEwKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudFBhZ2UgPiA2ICYmIHRoaXMuY3VycmVudFBhZ2UgPCB0aGlzLnBhZ2luYXRpb25MaXN0Lmxlbmd0aCAtIDQpIHtcclxuICAgICAgICAgICAgdGhpcy5xdHlQYWdMaXN0ID0gdGhpcy5wYWdpbmF0aW9uTGlzdC5zbGljZSh0aGlzLmN1cnJlbnRQYWdlIC0gNiwgdGhpcy5jdXJyZW50UGFnZSArIDQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXJyZW50UGFnZSA+PSB0aGlzLnBhZ2luYXRpb25MaXN0Lmxlbmd0aCAtIDQpIHtcclxuICAgICAgICAgICAgdGhpcy5xdHlQYWdMaXN0ID0gdGhpcy5wYWdpbmF0aW9uTGlzdC5zbGljZSgtMTApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYWdpbmF0aW9uLmRyYXdQYWdpbmF0aW9uKCk7XHJcbiAgICB9LFxyXG4gICAgZHJhd1BhZ2luYXRpb24oKSB7XHJcbiAgICAgICAgbGV0IHBhZ2luYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnaW5hdGlvbicpO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdpbmF0aW9uJykuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gICAgICAgIGxldCBmaXJzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBsZXQgZmlyc3RJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gICAgICAgIGZpcnN0SWNvbi5jbGFzc05hbWUgPSAnZmFzIGZhLTF4IGZhLWFuZ2xlLWRvdWJsZS1sZWZ0JztcclxuICAgICAgICBmaXJzdC5hcHBlbmRDaGlsZChmaXJzdEljb24pO1xyXG4gICAgICAgIGZpcnN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZmlyc3RQYWdlKTtcclxuICAgICAgICBwYWdpbmF0aW9uLmFwcGVuZENoaWxkKGZpcnN0KTtcclxuXHJcbiAgICAgICAgbGV0IHByZXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgbGV0IHByZXZJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gICAgICAgIHByZXZJY29uLmNsYXNzTmFtZSA9ICdmYXMgZmEtMXggZmEtYW5nbGUtbGVmdCc7XHJcbiAgICAgICAgcHJldi5hcHBlbmRDaGlsZChwcmV2SWNvbik7XHJcbiAgICAgICAgcHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHByZXZpb3VzUGFnZSk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChwcmV2KTtcclxuXHJcbiAgICAgICAgbGV0IHBhZ2VDb25hdGluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblxyXG4gICAgICAgIHRoaXMucXR5UGFnTGlzdC5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBwYWdlQ29uYXRpbmVyLmFwcGVuZENoaWxkKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBwYWdpbmF0aW9uLmFwcGVuZENoaWxkKHBhZ2VDb25hdGluZXIpO1xyXG5cclxuICAgICAgICBsZXQgbmV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBsZXQgbmV4dEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XHJcbiAgICAgICAgbmV4dEljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS0xeCBmYS1hbmdsZS1yaWdodCc7XHJcbiAgICAgICAgbmV4dC5hcHBlbmRDaGlsZChuZXh0SWNvbik7XHJcbiAgICAgICAgbmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG5leHRQYWdlKTtcclxuICAgICAgICBwYWdpbmF0aW9uLmFwcGVuZENoaWxkKG5leHQpO1xyXG5cclxuICAgICAgICBsZXQgbGFzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBsZXQgbGFzdEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XHJcbiAgICAgICAgbGFzdEljb24uY2xhc3NOYW1lID0gJ2ZhcyBmYS0xeCBmYS1hbmdsZS1kb3VibGUtcmlnaHQnO1xyXG4gICAgICAgIGxhc3QuYXBwZW5kQ2hpbGQobGFzdEljb24pO1xyXG4gICAgICAgIGxhc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsYXN0UGFnZSk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5hcHBlbmRDaGlsZChsYXN0KTtcclxuICAgIH0sXHJcblxyXG4gICAgdG9nZ2xlQ2xhc3MoKSB7XHJcbiAgICAgICAgdGhpcy5wYWdpbmF0aW9uTGlzdC5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdjdXJyZW50JykpO1xyXG4gICAgICAgIHRoaXMucXR5UGFnTGlzdC5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdjdXJyZW50JykpO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGFnaW5hdGlvbkxpc3RbdGhpcy5jdXJyZW50UGFnZSAtIDFdLmNsYXNzTmFtZSA9IFwiY3VycmVudFwiO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICByZW1vdmUoKXtcclxuICAgICAgICBsZXQgcGFnaW5hdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdpbmF0aW9uJyk7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhZ2luYXRpb24nKS5pbm5lckhUTUwgPSAnJztcclxuICAgIH0sXHJcblxyXG4gICAgbG9hZEV2ZW50cygpIHtcclxuICAgICAgICBwYWdpbmF0aW9uLnBhZ2luYXRpb25DdXQoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLnRvZ2dsZUNsYXNzKCk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5sb2FkQ29udGVudExpc3QoKTtcclxuICAgIH0sXHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIHBhZ2luYXRpb24uZ2V0U2NyZWVuV2lkdGgoKTtcclxuICAgICAgICBwYWdpbmF0aW9uLm1ha2VDb250ZW50TGlzdCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgIHRoaXMubnVtYmVyT2ZQYWdlcyA9IHBhZ2luYXRpb24uZ2V0TnVtYmVyT2ZQYWdlcygpO1xyXG4gICAgICAgIHBhZ2luYXRpb24ubWFrZVBhZ2luYXRpb25MaXN0KCk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5wYWdpbmF0aW9uQ3V0KCk7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5sb2FkQ29udGVudExpc3QoKTtcclxuXHJcbiAgICAgICAgcGFnaW5hdGlvbi5kcmF3TGlzdCgpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gY3VycmVudFBhZ2VOdW1iZXIoZXYpIHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBsZXQgcG9zaXRpb24gPSBwYXJzZUludChldi50YXJnZXQudGV4dCk7XHJcbiAgICBpZiAocG9zaXRpb24gIT09IHBhZ2luYXRpb24uY3VycmVudFBhZ2UpIHtcclxuICAgICAgICBwYWdpbmF0aW9uLmN1cnJlbnRQYWdlID0gcG9zaXRpb247XHJcbiAgICAgICAgcGFnaW5hdGlvbi5sb2FkRXZlbnRzKCk7XHJcbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBuZXh0UGFnZShldikge1xyXG4gICAgaWYgKHBhZ2luYXRpb24uY3VycmVudFBhZ2UgIT09IHBhZ2luYXRpb24ubnVtYmVyT2ZQYWdlcykge1xyXG4gICAgICAgIHBhZ2luYXRpb24uY3VycmVudFBhZ2UgKz0gMTtcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRFdmVudHMoKTtcclxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KClcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcHJldmlvdXNQYWdlKGV2KSB7XHJcbiAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKHBhZ2luYXRpb24uY3VycmVudFBhZ2UgIT09IDEpIHtcclxuICAgICAgICBwYWdpbmF0aW9uLmN1cnJlbnRQYWdlIC09IDE7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5sb2FkRXZlbnRzKCk7XHJcbiAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBmaXJzdFBhZ2UoZXYpIHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAocGFnaW5hdGlvbi5jdXJyZW50UGFnZSAhPT0gMSkge1xyXG4gICAgICAgIHBhZ2luYXRpb24uY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgIHBhZ2luYXRpb24ubG9hZEV2ZW50cygpO1xyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gbGFzdFBhZ2UoZXYpIHtcclxuICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAocGFnaW5hdGlvbi5jdXJyZW50UGFnZSAhPT0gcGFnaW5hdGlvbi5udW1iZXJPZlBhZ2VzKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbi5jdXJyZW50UGFnZSA9IHBhZ2luYXRpb24ubnVtYmVyT2ZQYWdlcztcclxuICAgICAgICBwYWdpbmF0aW9uLmxvYWRFdmVudHMoKTtcclxuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHtwYWdpbmF0aW9ufSBmcm9tIFwiLi9wYWdpbmF0aW9uXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZHJhd1NvcnRpbmcoKSB7XHJcbiAgICBsZXQgc29ydGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWx0ZXJzJyk7XHJcblxyXG4gICAgbGV0IGNhdGFsb2dGaWx0ZXJzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjYXRhbG9nRmlsdGVycy5jbGFzc05hbWUgPSAnY2F0YWxvZy1maWx0ZXJzJztcclxuXHJcbiAgICBsZXQgc29ydEZpbHRlcnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgIHNvcnRGaWx0ZXJzLmNsYXNzTmFtZSA9ICdzb3J0LWZpbHRlcic7XHJcblxyXG4gICAgbGV0IHNvcnRMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XHJcbiAgICBzb3J0TGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnc29ydCcpO1xyXG4gICAgc29ydExhYmVsLmlubmVyVGV4dCA9ICfQodC+0YDRgtC40YDQvtCy0LDRgtGMINC/0L4gOic7XHJcblxyXG4gICAgbGV0IHNvcnRTZWxlY3RCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO1xyXG4gICAgc29ydFNlbGVjdEJsb2NrLnNldEF0dHJpYnV0ZSgnaWQnLCAnc29ydCcpO1xyXG4gICAgc29ydFNlbGVjdEJsb2NrLnNldEF0dHJpYnV0ZSgnbmFtZScsICdzb3J0UHJvZHVjdHMnKTtcclxuICAgIHNvcnRTZWxlY3RCbG9jay5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBtYWtlU29ydGluZyk7XHJcblxyXG4gICAgbGV0IHNvcnRCeURlc2NlbmRpbmdQcmljZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgc29ydEJ5RGVzY2VuZGluZ1ByaWNlLnNldEF0dHJpYnV0ZSgndmFsdWUnLCAnZGVzY2VuZGluZycpO1xyXG4gICAgc29ydEJ5RGVzY2VuZGluZ1ByaWNlLmlubmVyVGV4dCA9ICfQv9C+INGD0LHRi9Cy0LDQvdC40Y4g0YbQtdC90YsnO1xyXG4gICAgc29ydFNlbGVjdEJsb2NrLmFwcGVuZENoaWxkKHNvcnRCeURlc2NlbmRpbmdQcmljZSk7XHJcblxyXG4gICAgbGV0IHNvcnRCeUFzY2VuZGluZ1ByaWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBzb3J0QnlBc2NlbmRpbmdQcmljZS5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgJ2FzY2VuZGluZycpO1xyXG4gICAgc29ydEJ5QXNjZW5kaW5nUHJpY2UuaW5uZXJUZXh0ID0gJ9C/0L4g0LLQvtC30YDQvtGB0YLQsNC90LjRjiDRhtC10L3Riyc7XHJcbiAgICBzb3J0U2VsZWN0QmxvY2suYXBwZW5kQ2hpbGQoc29ydEJ5QXNjZW5kaW5nUHJpY2UpO1xyXG5cclxuICAgIGxldCBzb3J0QWxwaGFiZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIHNvcnRBbHBoYWJldC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgJ2FscGhhYmV0Jyk7XHJcbiAgICBzb3J0QWxwaGFiZXQuaW5uZXJUZXh0ID0gJ9C/0L4g0LDQu9GE0LDQstC40YLRgyc7XHJcbiAgICBzb3J0U2VsZWN0QmxvY2suYXBwZW5kQ2hpbGQoc29ydEFscGhhYmV0KTtcclxuXHJcbiAgICBzb3J0RmlsdGVycy5hcHBlbmRDaGlsZChzb3J0TGFiZWwpO1xyXG4gICAgc29ydEZpbHRlcnMuYXBwZW5kQ2hpbGQoc29ydFNlbGVjdEJsb2NrKTtcclxuXHJcbiAgICBjYXRhbG9nRmlsdGVycy5hcHBlbmRDaGlsZChzb3J0RmlsdGVycyk7XHJcbiAgICBzb3J0aW5nLmFwcGVuZENoaWxkKGNhdGFsb2dGaWx0ZXJzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWFrZVNvcnRpbmcoKXtcclxuICAgIGxldCB2YWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3J0JykudmFsdWU7XHJcbiAgICBjb25zb2xlLmxvZyh2YWx1ZSk7XHJcbiAgICBpZih2YWx1ZSA9PT0gJ2FzY2VuZGluZycgKXtcclxuICAgICAgICBtYWtlQXNjZW5kaW5nU29ydGluZygpO1xyXG4gICAgfVxyXG4gICAgaWYodmFsdWUgPT09ICdkZXNjZW5kaW5nJyl7XHJcbiAgICAgICAgbWFrZURlc2NlbmRpbmdTb3J0aW5nKCk7XHJcbiAgICB9XHJcbiAgICBpZih2YWx1ZSA9PT0gJ2FscGhhYmV0Jyl7XHJcbiAgICAgICAgbWFrZUFscGhhYmV0U29ydGluZygpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtYWtlQXNjZW5kaW5nU29ydGluZygpIHtcclxuICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgICBsZXQgbGlzdCA9IHBhZ2luYXRpb24ubGlzdDtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZSA9IGZhbHNlO1xyXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbGlzdC5sZW5ndGggLSAoaSArIDEpOyBqKyspIHtcclxuICAgICAgICAgICAgbGV0IGEgPSBwYXJzZUZsb2F0KGxpc3Rbal0ucXVlcnlTZWxlY3RvcignZGl2LnNtLWRpdiBwLm1lbnUtaXRlbS1wcmljZScpLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgbGV0IGIgPSBwYXJzZUZsb2F0KGxpc3RbaiArIDFdLnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5zbS1kaXYgcC5tZW51LWl0ZW0tcHJpY2UnKS50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgIGlmIChhID4gYikge1xyXG4gICAgICAgICAgICAgICAgY2hhbmdlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIFtsaXN0W2pdLCBsaXN0W2ogKyAxXV0gPSBbbGlzdFtqICsgMV0sIGxpc3Rbal1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFjaGFuZ2UpIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbiAgICB9KTtcclxuICAgIHBhZ2luYXRpb24ubG9hZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtYWtlRGVzY2VuZGluZ1NvcnRpbmcoKSB7XHJcbiAgICBsZXQgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhaW5lcicpO1xyXG4gICAgbGV0IGxpc3QgPSBwYWdpbmF0aW9uLmxpc3Q7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aCAtIDE7IGkrKykge1xyXG4gICAgICAgIGxldCBjaGFuZ2UgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsaXN0Lmxlbmd0aCAtIChpICsgMSk7IGorKykge1xyXG4gICAgICAgICAgICBsZXQgYSA9IHBhcnNlRmxvYXQobGlzdFtqXS5xdWVyeVNlbGVjdG9yKCdkaXYuc20tZGl2IHAubWVudS1pdGVtLXByaWNlJykudGV4dENvbnRlbnQpO1xyXG4gICAgICAgICAgICBsZXQgYiA9IHBhcnNlRmxvYXQobGlzdFtqICsgMV0ucXVlcnlTZWxlY3RvcignZGl2LnNtLWRpdiBwLm1lbnUtaXRlbS1wcmljZScpLnRleHRDb250ZW50KTtcclxuICAgICAgICAgICAgaWYgKGEgPCBiKSB7XHJcbiAgICAgICAgICAgICAgICBjaGFuZ2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgW2xpc3Rbal0sIGxpc3RbaiArIDFdXSA9IFtsaXN0W2ogKyAxXSwgbGlzdFtqXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIWNoYW5nZSkgYnJlYWs7XHJcbiAgICB9XHJcbiAgICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcbiAgICBsaXN0LmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgICBwYWdpbmF0aW9uLmxvYWQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWFrZUFscGhhYmV0U29ydGluZygpIHtcclxuICAgIGxldCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFpbmVyJyk7XHJcbiAgICBsZXQgbGlzdCA9IHBhZ2luYXRpb24ubGlzdDtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICAgICAgbGV0IGNoYW5nZSA9IGZhbHNlO1xyXG5cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBsaXN0Lmxlbmd0aCAtIChpICsgMSk7IGorKykge1xyXG4gICAgICAgICAgICBsZXQgYSA9IGxpc3Rbal0ucXVlcnlTZWxlY3RvcignZGl2LnNtLWRpdiBoMi5tZW51LXRpdGxlJykudGV4dENvbnRlbnQudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgbGV0IGIgPSBsaXN0W2ogKyAxXS5xdWVyeVNlbGVjdG9yKCdkaXYuc20tZGl2IGgyLm1lbnUtdGl0bGUnKS50ZXh0Q29udGVudC50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICBpZiAoYSA+IGIpIHtcclxuICAgICAgICAgICAgICAgIGNoYW5nZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBbbGlzdFtqXSwgbGlzdFtqICsgMV1dID0gW2xpc3RbaiArIDFdLCBsaXN0W2pdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZighY2hhbmdlKSBicmVhaztcclxuICAgIH1cclxuICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSAnJztcclxuICAgIGxpc3QuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaXRlbSk7XHJcbiAgICB9KTtcclxuICAgIHBhZ2luYXRpb24ubG9hZCgpO1xyXG59Il19
